# Architecture Overview

> This file is generated by AI, please check the correctness of the content.

[繁體中文](../zh-TW/architecture.md)

## System Components

```mermaid
graph TB
    Client[FoxSwift Client]
    SignalServer[Signal Server]
    WebRTC[WebRTC P2P]
    Database[(PostgreSQL)]
    
    Client -->|REST API| SignalServer
    Client -->|WebSocket| SignalServer
    Client <-->|P2P Connection| WebRTC
    SignalServer <-->|Query/Update| Database
```

### Signal Server

- Handle WebRTC signal exchange
- Manage user connection states
- Provide REST API services
- WebSocket real-time communication

### Database

- Store user information
- Record connection history
- Manage system settings

## Data Flow

### WebRTC Signaling Flow

```mermaid
sequenceDiagram
    participant A as Client A
    participant S as Signal Server
    participant B as Client B
    
    A->>S: Connect (WebSocket)
    B->>S: Connect (WebSocket)
    
    A->>S: Create Offer
    S->>B: Forward Offer
    B->>S: Create Answer
    S->>A: Forward Answer
    
    loop ICE Candidate Exchange
        A->>S: Send ICE Candidate
        S->>B: Forward ICE Candidate
        B->>S: Send ICE Candidate
        S->>A: Forward ICE Candidate
    end
    
    A <<->> B: Direct P2P Connection Established
```

### State Management

- User State
  - Online/Offline
  - Connection Status
  - Last Seen

- Connection State
  - Signaling
  - Connected
  - Disconnected

## Technology Stack

### Backend

- Vapor
- Swift 6.0
- PostgreSQL
- WebSocket Protocol
- Docker
